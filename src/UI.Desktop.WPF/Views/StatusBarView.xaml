<UserControl x:Class="UI.Desktop.WPF.Views.StatusBarView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:local="clr-namespace:UI.Desktop.WPF.Views"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             d:DesignHeight="450"
             d:DesignWidth="800"
             mc:Ignorable="d">
  <UserControl.Resources>
    <!--  Defines the default style for the error bar  -->
    <Style x:Key="NotificationBarStyle" TargetType="TextBlock">
      <Setter Property="Visibility" Value="Visible" />
      <Style.Triggers>
        <DataTrigger Binding="{Binding Path=UiService.StatusBar.Notification.Length}" Value="0">
          <Setter Property="Visibility" Value="Hidden" />
        </DataTrigger>
        <EventTrigger RoutedEvent="Binding.TargetUpdated">
          <EventTrigger.Actions>
            <BeginStoryboard>
              <Storyboard>
                <ColorAnimation AutoReverse="True"
                                FillBehavior="Stop"
                                RepeatBehavior="Forever"
                                Storyboard.TargetProperty="(TextBlock.Background).(SolidColorBrush.Color)"
                                From="AliceBlue"
                                To="OrangeRed"
                                Duration="0:0:0.5" />
              </Storyboard>
            </BeginStoryboard>
          </EventTrigger.Actions>
        </EventTrigger>
      </Style.Triggers>
    </Style>

    <Style TargetType="{x:Type GroupBox}">
      <Setter Property="HeaderTemplate">
        <Setter.Value>
          <DataTemplate>
            <TextBlock FontStyle="Italic"
                       FontWeight="Light"
                       Foreground="LightSlateGray"
                       Text="{Binding}" />
          </DataTemplate>
        </Setter.Value>
      </Setter>
    </Style>

  </UserControl.Resources>
  <Grid>
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto" />
      <RowDefinition Height="Auto" />
    </Grid.RowDefinitions>

    <Separator Grid.Row="0" Margin="0 0 0 0" />

    <StatusBar Grid.Row="1" Background="#dddddd">
      <StatusBar.ItemsPanel>
        <ItemsPanelTemplate>
          <Grid>
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
          </Grid>
        </ItemsPanelTemplate>
      </StatusBar.ItemsPanel>
      <StatusBarItem Grid.Column="0" HorizontalContentAlignment="Stretch">
        <TextBlock Text="{Binding UiService.StatusBar.StatusText}" />
      </StatusBarItem>
      <StatusBarItem Grid.Column="0"
                     Grid.ColumnSpan="3"
                     HorizontalContentAlignment="Stretch"
                     VerticalContentAlignment="Stretch">
        <TextBlock Background="AliceBlue"
                   FontWeight="Bold"
                   Foreground="#005BAC"
                   Style="{StaticResource NotificationBarStyle}"
                   Text="{Binding UiService.StatusBar.Notification,
                                  NotifyOnTargetUpdated=True}"
                   TextAlignment="Center"
                   TextWrapping="Wrap"
                   Visibility="{Binding UiService.StatusBar.Notification,
                                        Converter={StaticResource StringNullOrEmptyVisibilityConverter}}" />
      </StatusBarItem>
    </StatusBar>
  </Grid>
</UserControl>
